---
title: "Grant Proposal: R Kubernetes Client Library"
author: "Alexandru Mahmoud"
date: "2024-09-25"
output: html_document
---

# The Problem

The R programming language has become increasingly popular in data science, statistical computing, and bioinformatics. However, it lacks native support for orchestrating and managing containerized applications in Kubernetes environments. This gap presents several challenges:

1. **Limited accessibility**: R users, particularly in academic and research settings, often struggle to leverage the power of Kubernetes for scaling their computational workflows.

2. **Dependency on external tools**: Current solutions require R users to rely on external CLI tools or wrappers, introducing complexity and potential compatibility issues, hindering both reproducibility, especially important for scientific users, and portability, useful for industry and general users.

3. **Steep learning curve leading to underutilization of cloud resources**: R users must learn additional technologies and paradigms to work with Kubernetes, creating a barrier to adoption. The absence of a native R client for Kubernetes hinders seamless integration of containerized applications within R-based data analysis pipelines. Thus, many R users are unable to fully leverage cloud-based Kubernetes clusters for distributed computing, limiting the scale and efficiency of their analyses.

Other attempts to address this problem have been limited in scope, often relying on CLI tools and providing narrow functionalities for specific cloud providers, and have gone unmaintained for several years. These solutions failed to offer a comprehensive, R-native approach to Kubernetes interaction, and no R package could be found on CRAN or GitHub allowing users to universally interact with a Kubernetes cluster.

Tackling this problem is crucial for several reasons:

- It will empower R users to harness the full potential of container orchestration and cloud computing.
- It will bridge the gap between statistical computing and modern DevOps practices.
- It will enable more efficient and scalable computational workflows in fields such as bioinformatics, where R is widely used.
- It will foster greater collaboration between data scientists and infrastructure teams, bringing the possibility for the former to leverage infrastructure in their R code.


# The proposal

## Overview

We propose the development of a comprehensive, native R client library for Kubernetes. This library will provide a seamless interface between R and Kubernetes, allowing users to interact with Kubernetes clusters directly from their R environment. Key features of our proposal include:

1. A dynamic API wrapper that adapts to any active Kubernetes cluster, including support for Custom Resource Definitions (CRDs).
2. Bespoke services for core Kubernetes resources, offering an intuitive and R-idiomatic way to manage common objects like Namespaces, Pods, Services, etc...
3. Comprehensive documentation and tutorials to facilitate adoption by the R community.

This project is endorsed by Bioconductor, with Core team members committed to providing feedback and guidance throughout the development process. This endorsement ensures that the library will be developed in alignment with Bioconductor's high standards and will seamlessly integrate with the broader Bioconductor ecosystem in the future.

This project will significantly benefit the R community by:

- Enabling R users to easily deploy and manage containerized applications and workflows.
- Providing a native, dependency-free solution for Kubernetes interaction.
- Facilitating the use of cloud resources for computationally intensive tasks in R.
- Streamlining the development of scalable, reproducible research environments.
- Fostering collaboration between R developers and DevOps teams.

## Detail

Our proposed R-based Kubernetes client library will be built on the following architecture:

1. **Dynamic API Wrapper**: A dynamic, generated set of R functions that map directly to the Kubernetes API endpoints. This component will use the `rapiclient` package to interact with the Kubernetes API server. This dynamic wrapper will provide expert users full access to all API functions wrapping the server's schema (including API extensions added to the cluster via Custom Resource Definitions)

2. **Resource-Specific Functions**: A layer of R functions providing intuitive, high-level interactions with common Kubernetes resources. These functions will be implemented based on the core Kubernetes API schema, enabling general users easy access to basic CRUD operations on core resources (eg: `create_namespace(name="my-ns")`, `delete_job(name='my-job', namespace='my-ns')`, `apply_pod(name='my-job', namespace='my-ns', spec=newjobspec)`

3. **Authentication and Configuration**: Utilities for managing Kubernetes authentication and cluster configuration within R sessions. Starting with basic kubeconfig management.

The Minimum Viable Product (MVP) will include:

- Complete API wrapper generation for Kubernetes server
- CRUD operations for Core resources (Pods, ReplicaSets, Deployments, StatefulSets, DaemonSets, Jobs, CronJobs, Services, Ingress, ConfigMaps, Secrets, PersistentVolumes, PersistentVolumeClaims, Namespaces, Roles, RoleBindings, ClusterRoles, ClusterRoleBindings, ServiceAccounts)
- Basic cluster authentication and configuration management (Events and KubeConfig)
- Comprehensive documentation and usage examples

# Requirements

## People

The project will require:

1. One lead developer with experience in both R package development and Kubernetes
2. Advisory input from Kubernetes experts and the Bioconductor Core team

## Processes

We will implement the following processes:

1. Set up a public GitHub repository for transparent development
2. Add contribution guidelines and adopt a Code of Conduct, to create an inviting space for community contributions
3. Conduct quarterly progress reviews open to the community
4. Implement a thorough code review process to ensure the quality of community contributions

## Tools & Tech

The project will utilize:

1. R (version 4.4+) and relevant CRAN packages (e.g., rapiclient, httr)
2. Git for version control
3. GitHub for project management, community engagement, and collaboration
4. Jetstream2 for cloud resources
5. A Kubernetes cluster for development and testing (local k3s cluster & RKE2 on Jetstream2)
6. CI/CD tools (e.g., GitHub Actions) for automated testing

## Funding

We request funding for personnel costs for one developer part-time (18 months), potential paid interns (eg: 12 months development intern + 3-6 months outreach & community development intern), and some consulting funds.

Total requested funding: $100,000

This project will also receive material support from the Bioconductor Project, in the form of access to the NSF Jetstream2 allocation, where a Kubernetes cluster will be used for development and testing, as well as guidance from the Bioconductor Core team.

## Summary

The requested funding will support a dedicated developer to create, test, and document a native R client for Kubernetes over 18 months. This developer will tentatively be aided by a long-term software engineering intern, as well as interns aiding with outreach and community development. This investment, coupled with guidance from the Bioconductor Core team, will result in a powerful tool that bridges the gap between R and modern container orchestration, benefiting a wide range of R users in academia, research, and industry.

# Signatories

## Project team

- Alexandru Mahmoud - Lead Developer

## Contributors

- Marcel Ramos - Bioconductor Core Team Member & rapiclient package maintainer

# Success

## Definition of done

The project will be considered complete when:

1. The R package is available on CRAN, with Bioconductor Core team having reviewed and approved the package
2. The library supports interaction with all core Kubernetes resources, and dynamic wrappers for API extensions
3. Full documentation and tutorials are published
4. At least one real-world example of the library's use is published
5. The library is listed as a community-maintained R library on the official list of Kubernetes client libraries: https://kubernetes.io/docs/reference/using-api/client-libraries/

## Measuring success

We will track the following metrics:

1. Number of GitHub stars and forks
2. Number of CRAN downloads
3. Community contributions, engagement, and issue resolution rate
4. Adoption in academic papers and/or industry projects

## Future work

Potential extensions include:

1. Integration with BiocParallel for distributed computing on Kubernetes clusters (with funding potentially available via Bioconductor NIH grant)
2. Integration with other R parallelization frameworks
3. Development of high-level workflow templates for common bioinformatics tasks

## Key risks

Rapid changes in Kubernetes API versions and core resources, requiring a dynamic design, avoiding hardcoded API versions.

# Project plan

## Start-up phase (Months 1-3)

1. (Done) Set up GitHub repository with license, code of conduct, contribution guidelines, and proof-of-concept code
2. Announce the project on relevant R and Kubernetes forums, and invite community feedback and contributions
3. Finalize detailed technical specifications with community input

## Technical delivery

- Months 4-6: Develop core API wrapper and resource-specific functions, assuming identity from kubeconfig
- Months 7-9: Implement a variety of ways to authenticate with clusters (eg: direct auth with cloud provider)
- Months 9-12: Finalization of first version, and addition of comprehensive testing
- Months 12-18: Documentation, tutorials, and submission to CRAN and Kubernetes client libraries list
